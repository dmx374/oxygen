// +--------------------------------------------------------------------+ \\
// ¦ OxygenJS 0.2.4 - High Performance JavaScript MicroTemplating       ¦ \\
// +--------------------------------------------------------------------+ \\
// ¦ Copyright © 2016 Vincent Fontaine                                  ¦ \\
// +---------+----------------------------------------------------------+ \\
// ¦ CREDITS |                                                          ¦ \\
// +---------+                                                          ¦ \\
// ¦   * Kru for the reduce tip                                         ¦ \\
// ¦   * NunJucks for the Jinja like filters                            ¦ \\
// ¦   * John Resig for his excellent work (http://ejohn.org/)          ¦ \\
// +--------------------------------------------------------------------+ \\
!function(){var t={},r=document,n=Object.prototype.toString,e=function(t){return r.getElementById(t)?r.getElementById(t).innerHTML:""},i=function(t){if("string"!=typeof t)return t
this.toString=function(){return t},this.length=t.length
for(var r=["charAt","charCodeAt","concat","contains","endsWith","fromCharCode","indexOf","lastIndexOf","length","localeCompare","match","quote","replace","search","slice","split","startsWith","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"],n=0;n<r.length;n++)this[r[n]]=proxyStr(t[r[n]])},o=function(t,r){return t instanceof i?new i(r):r.toString()},u={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"},a={escape:function(t){return t.replace(/[&"'<>]/g,function(t){return u[t]})},isFunction:function(t){return"[object Function]"==n.call(t)},isArray:Array.isArray||function(t){return"[object Array]"==n.call(t)},isString:function(t){return"[object String]"==n.call(t)},isObject:function(t){return t===Object(t)},repeat:function(t,r){for(var n="",e=0;r>e;e++)n+=t
return n},map:function(t,r){var n=[]
if(null==t)return n
if(Array.prototype.map&&t.map===Array.prototype.map)return t.map(r)
for(var e=0;e<t.length;e++)n[n.length]=r(t[e],e)
return t.length===+t.length&&(n.length=t.length),n}},f=function(t,r){var n=r.split("|").reduce(function(t,r){var n=r.indexOf("(")+1||r.length,e=n==r.length
return"O2.filters."+r.substring(0,n)+(e?"(":"")+t+(e?")":", ")+r.substring(n)})
return"', "+n+", '"},s=function(t,r){return null===t||void 0===t||t===!1?r:t}
this.O2=function(r,n){var i=/\W/.test(r)?new Function("obj","var p=[];with(obj){p.push('"+r.replace(/{%[ ]*for ([$a-zA-Z_]+) in ([$a-zA-Z_]+([.][$a-zA-Z_]+)*)[ ]*%}/g,"{% for (var $1=0; $1<$2.length; $1++) { %}").replace(/{%[ ]*if (.+[^ ]{1})[ ]*%}/g,"{% if ($1) { %}").replace(/{%[ ]*end[if|for]*[ ]*%}/g,"{% } %}").replace(/{%[ ]*else[ ]*%}/g,"{% }else{ %}").replace(/[\r\t\n]/g," ").split("{%").join("');").split("%}").join("p.push('").split("\r").join("\\'").replace(/{{2}[ ]*([^{}, ]*[^{}]*[^{}, ]+)[ ]*}{2}/g,f)+"');}return p.join('');"):t[r]=t[r]||O2(e(r))
return n?i(n):i},this.O2.filters={abs:function(t){return Math.abs(t)},batch:function(t,r,n){for(var e=[],i=[],o=0;o<t.length;o++)o%r===0&&i.length&&(e.push(i),i=[]),i.push(t[o])
if(i.length){if(n)for(var o=i.length;r>o;o++)i.push(n)
e.push(i)}return e},capitalize:function(t){t=s(t,"")
var r=t.toLowerCase()
return o(t,r.charAt(0).toUpperCase()+r.slice(1))},center:function(t,r){if(t=s(t,""),r=r||80,t.length>=r)return t
var n=r-t.length,e=a.repeat(" ",n/2-n%2),i=a.repeat(" ",n/2)
return o(t,e+t+i)},"default":function(t,r,n){return n?t?t:r:void 0!==t?t:r},dictsort:function(t,r,n){if(!a.isObject(t))throw new"dictsort filter: val must be an object"
var e=[]
for(var i in t)e.push([i,t[i]])
var o
if(void 0===n||"key"===n)o=0
else{if("value"!==n)throw new"dictsort filter: You can only sort by either key or value"
o=1}return e.sort(function(t,n){var e=t[o],i=n[o]
return r||(a.isString(e)&&(e=e.toUpperCase()),a.isString(i)&&(i=i.toUpperCase())),e>i?1:e===i?0:-1}),e},dump:function(t){return JSON.stringify(t)},escape:function(t){return"string"==typeof t||t instanceof i?a.escape(t):t},safe:function(t){return new i(t)},first:function(t){return t[0]},groupby:function(t,r){for(var n={},e=a.isFunction(r)?r:function(t){return t[r]},i=0;i<t.length;i++){var o=t[i],u=e(o,i);(n[u]||(n[u]=[])).push(o)}return n},indent:function(t,r,n){if(t=s(t,""),""===t)return""
r=r||4
for(var e="",i=t.split("\n"),u=a.repeat(" ",r),f=0;f<i.length;f++)e+=0!==f||n?u+i[f]+"\n":i[f]+"\n"
return o(t,e)},join:function(t,r,n){return r=r||"",n&&(t=a.map(t,function(t){return t[n]})),t.join(r)},last:function(t){return t[t.length-1]},length:function(t){var r=s(val,"")
return void 0!==r?r.length:0},list:function(t){if(a.isString(t))return t.split("")
if(a.isObject(t)){var r=[]
if(Object.keys)r=Object.keys(t)
else for(var n in t)r.push(n)
return a.map(r,function(r){return{key:r,value:t[r]}})}if(a.isArray(t))return t
throw new"list filter: type not iterable"},lower:function(t){return t=s(t,""),t.toLowerCase()},random:function(t){return t[Math.floor(Math.random()*t.length)]},rejectattr:function(t,r){return t.filter(function(t){return!t[r]})},selectattr:function(t,r){return t.filter(function(t){return!!t[r]})},replace:function(t,r,n,e){var u="",a=t
if(r instanceof RegExp)return t.replace(r,n)
if("undefined"==typeof e&&(e=-1),"number"==typeof r)r+=""
else if("string"!=typeof r)return t
if("number"==typeof t&&(t+=""),"string"!=typeof t&&!(t instanceof i))return t
if(""===r)return u=n+t.split("").join(n)+n,o(t,u)
var f=t.indexOf(r)
if(0===e||-1===f)return t
for(var s=0,c=0;f>-1&&(-1===e||e>c);)u+=t.substring(s,f)+n,s=f+r.length,c++,f=t.indexOf(r,s)
return s<t.length&&(u+=t.substring(s)),o(a,u)},reverse:function(t){var r
return r=a.isString(t)?this.list(t):a.map(t,function(t){return t}),r.reverse(),a.isString(t)?o(t,r.join("")):r},round:function(t,r,n){r=r||0
var e,i=Math.pow(10,r)
switch(n){case"ceil":e=Math.ceil
break
case"floor":e=Math.floor
break
default:e=Math.round}return e(t*i)/i},slice:function(t,r,n){for(var e=Math.floor(t.length/r),i=t.length%r,o=0,u=[],a=0;r>a;a++){var f=o+a*e
i>a&&o++
var s=o+(a+1)*e,c=t.slice(f,s)
n&&a>=i&&c.push(n),u.push(c)}return u},sum:function(t,r,n){var e=0
"number"==typeof n&&(e+=n),r&&(t=a.map(t,function(t){return t[r]}))
for(var i=0;i<t.length;i++)e+=t[i]
return e},sort:function(t,r,n,e){return t=a.map(t,function(t){return t}),t.sort(function(t,i){var o,u
return e?(o=t[e],u=i[e]):(o=t,u=i),!n&&a.isString(o)&&a.isString(u)&&(o=o.toLowerCase(),u=u.toLowerCase()),u>o?r?1:-1:o>u?r?-1:1:0}),t},string:function(t){return o(t,t)},striptags:function(t,r){t=s(t,""),r=r||!1
var n=/<\/?([a-z][a-z0-9]*)\b[^>]*>|<!--[\s\S]*?-->/gi,e=filters.trim(t.replace(n,"")),i=""
return i=r?e.replace(/^ +| +$/gm,"").replace(/ +/g," ").replace(/(\r\n)/g,"\n").replace(/\n\n\n+/g,"\n\n"):e.replace(/\s+/gi," "),o(t,i)},title:function(t){t=s(t,"")
for(var r=t.split(" "),n=0;n<r.length;n++)r[n]=this.capitalize(r[n])
return o(t,r.join(" "))},trim:function(t){return o(t,t.replace(/^\s*|\s*$/g,""))},truncate:function(t,r,n,e){var i=t
if(t=s(t,""),r=r||255,t.length<=r)return t
if(n)t=t.substring(0,r)
else{var u=t.lastIndexOf(" ",r);-1===u&&(u=r),t=t.substring(0,u)}return t+=void 0!==e&&null!==e?e:"...",o(i,t)},upper:function(t){return t=s(t,""),t.toUpperCase()},urlencode:function(t){var r,n=encodeURIComponent
if(a.isString(t))return n(t)
if(a.isArray(t))r=t.map(function(t){return n(t[0])+"="+n(t[1])})
else{r=[]
for(var e in t)t.hasOwnProperty(e)&&r.push(n(e)+"="+n(t[e]))}return r.join("&")},wordcount:function(t){return t=s(t,""),t.match(/\w+/g).length},"float":function(t,r){var n=parseFloat(t)
return isNaN(n)?r:n},"int":function(t,r){var n=parseInt(t,10)
return isNaN(n)?r:n}}}()
