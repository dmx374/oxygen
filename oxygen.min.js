(function(){var i={},h=document,a=Object.prototype.toString,f=function(c){return h.getElementById(c)?h.getElementById(c).innerHTML:" "};var e=function(m){if(typeof m!="string"){return m}this.toString=function(){return m};this.length=m.length;var c=["charAt","charCodeAt","concat","contains","endsWith","fromCharCode","indexOf","lastIndexOf","length","localeCompare","match","quote","replace","search","slice","split","startsWith","substr","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"];for(var d=0;d<c.length;d++){this[c[d]]=proxyStr(m[c[d]])}};var l=function(c,d){if(c instanceof e){return new e(d)}return d.toString()};var g={"&":"&amp;",'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;"};var j={escape:function(c){return c.replace(/[&"'<>]/g,function(d){return g[d]})},isFunction:function(c){return a.call(c)=="[object Function]"},isArray:Array.isArray||function(c){return a.call(c)=="[object Array]"},isString:function(c){return a.call(c)=="[object String]"},isObject:function(c){return c===Object(c)},repeat:function(p,o){var m="";for(var d=0;d<o;d++){m+=p}return m},map:function(n,m){var d=[];if(n==null){return d}if(Array.prototype.map&&n.map===Array.prototype.map){return n.map(m)}for(var c=0;c<n.length;c++){d[d.length]=m(n[c],c)}if(n.length===+n.length){d.length=n.length}return d}};var b=function(c,m){var d=m.split("|").reduce(function(n,q){var p=(q.indexOf("(")+1)||q.length,o=(p==q.length);return"O2.filters."+q.substring(0,p)+(o?"(":"")+n+(o?")":", ")+q.substring(p)});return"', "+d+", '"};this.O2=function k(m,c){var d=!/\W/.test(m)?i[m]=i[m]||O2(f(m)):new Function("obj","var p=[];with(obj){p.push('"+m.replace(/{%[ ]*for ([$a-zA-Z_]+) in ([$a-zA-Z_]+([.][$a-zA-Z_]+)*)[ ]*%}/g,"{% for (var $1=0; $1<$2.length; $1++) { %}").replace(/{%[ ]*if (.+[^ ]{1})[ ]*%}/g,"{% if ($1) { %}").replace(/{%[ ]*end[if|for]*[ ]*%}/g,"{% } %}").replace(/{%[ ]*else[ ]*%}/g,"{% }else{ %}").replace(/[\r\t\n]/g," ").split("{%").join("');").split("%}").join("p.push('").split("\r").join("\\'").replace(/{{2}[ ]*([^{}, ]*[^{}]*[^{}, ]+)[ ]*}{2}/g,b)+"');}return p.join('');");return c?d(c):d};this.O2.filters={abs:function(c){return Math.abs(c)},batch:function(c,o,p){var n=[],m=[];for(var d=0;d<c.length;d++){if(d%o===0&&m.length){n.push(m);m=[]}m.push(c[d])}if(m.length){if(p){for(var d=m.length;d<o;d++){m.push(p)}}n.push(m)}return n},capitalize:function(d){var c=d.toLowerCase();return l(d,c[0].toUpperCase()+c.slice(1))},center:function(o,m){m=m||80;if(o.length>=m){return o}var c=m-o.length,n=j.repeat(" ",c/2-c%2),d=j.repeat(" ",c/2);return l(o,n+o+d)},"default":function(d,c){return d?d:c},dictsort:function(o,n,m){if(!j.isObject(o)){throw new ("dictsort filter: val must be an object")}var p=[];for(var c in o){p.push([c,o[c]])}var d;if(m===undefined||m==="key"){d=0}else{if(m==="value"){d=1}else{throw new ("dictsort filter: You can only sort by either key or value")}}p.sort(function(t,s){var r=t[d];var q=s[d];if(!n){if(j.isString(r)){r=r.toUpperCase()}if(j.isString(q)){q=q.toUpperCase()}}return r>q?1:(r==q?0:-1)});return p},escape:function(c){if(typeof c=="string"||c instanceof e){return j.escape(c)}return c},safe:function(c){return new e(c)},first:function(c){return c[0]},groupby:function(p,q){var c={},n=j.isFunction(q)?q:function(r){return r[q]};for(var m=0;m<p.length;m++){var o=p[m],d=n(o,m);(c[d]||(c[d]=[])).push(o)}return c},indent:function(p,n,q){n=n||4;var m="",c=p.split("\n"),o=j.repeat(" ",n);for(var d=0;d<c.length;d++){if(d==0&&!q){m+=c[d]+"\n"}else{m+=o+c[d]+"\n"}}return l(p,m)},join:function(d,m,c){m=m||"";if(c){d=j.map(d,function(n){return n[c]})}return d.join(m)},last:function(c){return c[c.length-1]},length:function(c){return c.length},lower:function(c){return c.toLowerCase()},random:function(c){var d=Math.floor(Math.random()*c.length);if(d==c.length){d--}return c[d]},replace:function(q,c,d,p){var m=q,o=m,n=1;m=m.replace(c,d);while(o!=m){if(n>=p){break}o=m;m=m.replace(c,d);n++}return l(q,m)},reverse:function(d){var c=j.map(d,function(m){return m});c.reverse();return c},round:function(n,c,o){c=c||0;var d=Math.pow(10,c),m;if(o=="ceil"){m=Math.ceil}else{if(o=="floor"){m=Math.floor}else{m=Math.round}}return m(n*d)/d},slice:function(p,t,q){var u=Math.floor(p.length/t),d=p.length%t,n=0,r=[];for(var o=0;o<t;o++){var c=n+o*u;if(o<d){n++}var m=n+(o+1)*u,s=p.slice(c,m);if(q&&o>=d){s.push(q)}r.push(s)}return r},sort:function(d,m,n,c){d=j.map(d,function(o){return o});d.sort(function(q,p){var o,r;if(c){o=q[c];r=p[c]}else{o=q;r=p}if(!n&&j.isString(o)&&j.isString(r)){o=o.toLowerCase();r=r.toLowerCase()}if(o<r){return m?1:-1}else{if(o>r){return m?-1:1}else{return 0}}});return d},string:function(c){return l(c,c)},title:function(m){var d=m.split(" ");for(var c=0;c<d.length;c++){d[c]=this.capitalize(d[c])}return l(m,d.join(" "))},trim:function(c){return l(c,c.replace(/^\s*|\s*$/g,""))},truncate:function(m,n,o,d){var p=m;n=n||255;if(m.length<=n){return m}if(o){m=m.substring(0,n)}else{var c=m.lastIndexOf(" ",n);if(c===-1){c=n}m=m.substring(0,c)}m+=(d!==undefined&&d!==null)?d:"...";return l(p,m)},upper:function(c){return c.toUpperCase()},wordcount:function(c){return c.match(/\w+/g).length},"float":function(m,d){var c=parseFloat(m);return isNaN(c)?d:c},"int":function(m,d){var c=parseInt(m,10);return isNaN(c)?d:c}}})();